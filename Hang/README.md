# Hang(OS)(System)
시스템, 네트워크, 어플리케이션이 동작하지 않고 서비스가 응답하지 않는 상태 즉, 시스템 입출력에 대한 반응이 없는 상태로 시스템 운영이 불가능한 상태  
서버에서 무엇을 입력해도 안먹히고 화면도 안나오지만 서버자체는 가동되고있는 그런 상황

<br/>

## 원인
### 하드웨어
1. 하드웨어의 결함
2. 환경적인 요인으로 인한 하드웨어 열 데미지
3. Thread / Memory 부족

### 소프트웨어
1. Infinite Loop / Race Condition
2. Deadlock
3. Spyware

<br/>

## 시스템 Hang을 위한 모니터링
실제로 Hang을 유발하고 있는 요인을 해결해주면 되지만, 쉽지 않다.  
Hang은 결국엔 재부팅을 해야 하는데 그 원인을 찾아야 대안을 낼 수 있기 때문에 이러한 시스템 Hang이 발생하게 되는 원인을 파악하기 위해서는 기본적으로 자원에 대한 모니터링이 필요하다.
1. CPU, Memory, Process Status, Heat와 같은 시스템 자원과 동작에 대한 모니터링
2. 로그 모니터링 - 프로그램(커널 / 어플리케이션) 비정상 종료 실패
3. Heartbeat - 간단한 메세지를 보내 응답이 오고 있는지를 확인하는 모니터링

<br/>

## Hang의 예방책
1. 장비의 스펙을 향상
2. Garbage Collection 튜닝
3. Log를 통해 Hang up 직전의 호출을 분석

<br/>

## Hang vs Panic
### Hang
행은 말 그대로 정지(중단)된 상태를 말하는데, 커널 자신이 스스로 시스템의 문제를 인식하지 못하여, 결국은 시스템 마비를 일으킨 상태다. 이런 경우에는 원인을 분석하기 쉽지 않다.

Hang은 다른 말로 'freeze' 또는 'get stuck'으로 표현하기도 한다. 대개 시스템이 잠시라도 먹통 되면 '행 걸렸다'라고 하는데, 이는 행이 아니다. 행은 절대 돌아오지 않는다. 잠깐 중단되었다 풀리는 것은 행이 아닌 것이다.
- 커널 스스로 문제를 인식하지 못하여 시스템이 정지된 상태
- 원인 분석이 어려움
- 강제 Panic 가능

### Panic
패닉은 컴퓨터 내부의 일종의 커널 프로그램 중 하나이다. 커널은 시스템의 중요한 부분을 주기적으로 검사한다. 만일 시스템 내부에 크리티컬 한 결함이 발생되면, 이를 사용자에게 통지하고 시스템을 자동 reset한다. 왜냐하면 그 결함에 의해 다른 정상적인 부분까지 확대된다면, 돌이킬 수 없는 심각한 문제를 초래할 수도 있기에 해당 시점에 중단하는 것이다.

패닉이 된 것은 컴퓨터에 문제가 발생한 것이다. 그리고, 원인 분석이 가능한 덤프 파일이 생긴다. 그러나, 문제가 발생했음에도 불구하고, 패닉이 일어나지 않는 경우의 대부분은 행 (Hang)이다.
- 커널 프로그램 중 하나, `panic()`
- 중대 결함 발생 시 시스템 자동 Reset (Dump 수행)
- 문제 발생 시 Panic이 일어나지 않는 경우 대부분 Hang이 됨

<br/>

## Reference
- https://www.mantech.co.kr/hang-solutions/
- https://www.morenice.kr/79
- https://youngswooyoung.tistory.com/62
- https://performance.tistory.com/26